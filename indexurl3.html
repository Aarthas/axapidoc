<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
  <meta name="format-detection" content="telephone=no">
  <title>三江购物</title>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/vue/1.0.7/vue.min.js"></script>
</head>


<body>

<input type="button" value="加1" onclick="add()" />
<div id="info" style="border:red 1px solid;width:200px;padding:10px;">0</div>
<script>
    var info = document.getElementById('info');
    var i = 1;
    function add() {
        var data = {
            param : i,
            func : func
        };
        info.innerHTML = i;
        document.title = i;
        History.push(data);
        i++;

    }

    function func(i) {
        info.innerHTML = i;
        document.title = i;
    }

    History = function() {
        var
            list = [],
            index = 1,

            func, scope;

        function push(data) {
            if(typeof data !== 'object') return;

            if(typeof data.param == undefined || typeof data.func !== 'function') return;

            func = data.func;
            scope = data.scope;

            history.replaceState({param: data.param}, index, '#' + index);
            console.log('aaaa'+index)
            index++;
            window.location.href='http://www.cnblogs.com/bigbearbb/p/4257743.html'
        }

        window.onpopstate = function(e) {
            if(e.state) {
                var state = e.state,
                    param = state.param;
                if(param) {
                    func.call(scope, param);
                }
            }
            else{
                if(func){
                    func.call(scope, 0);
                }

            }

        }

        return {
            push : push
        };
    }();
</script>

</body>
</html>
